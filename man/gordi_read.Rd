% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gordi_read.R
\name{gordi_read}
\alias{gordi_read}
\title{Read ordination output into a standardized structure}
\usage{
gordi_read(
  m,
  env = NULL,
  spe = NULL,
  traits = NULL,
  choices = 1:2,
  scaling = "symm",
  correlation = F,
  hill = F,
  const = c(2, 2),
  species_score_type = c("lc", "wa")
)
}
\arguments{
\item{m}{An ordination result: object of class \code{rda}, \code{cca}, \code{capscale},
\code{decorana}, or \code{metaMDS}.}

\item{env}{A data frame with environmental variables of samples; must have
the same number of samples (rows) as the species table. Defaults to \code{NULL}.}

\item{spe}{A data frame of species abundances or community data. This is crucial
if the ordination (\code{capscale} or \code{metaMDS}) was calculated on a 
distance matrix and you require species scores. Defaults to \code{NULL}.}

\item{traits}{A data frame of species traits; one species can have only one
trait value in its dedicated column. Defaults to \code{NULL}.}

\item{choices}{Numeric vector of selected ordination axes; defaults to the
first two axes.}

\item{scaling}{Scaling of species and site scores; see \code{\link[vegan]{scores.cca}}
for options. Defaults to \code{'symm'}.}

\item{correlation}{Logical; default = \code{FALSE}. If \code{TRUE}, predictor
scores are standardized to correlation scores (only relevant for linear methods).
See \code{\link[vegan]{scores.cca}} or \code{\link[vegan]{scores.rda}} for details.}

\item{hill}{Logical; default = \code{FALSE}. If \code{TRUE}, sites and species are scaled
to show separation for Hill's distance (only relevant for CCA). See \code{\link[vegan]{scores.cca}}
for details.}

\item{const}{Numeric vector of length 1 or 2. Scaling constant(s) for sites and species
when the method is not CA/CCA/RDA. Passed to \code{\link[vegan]{scores}}. Defaults to \code{c(2, 2)}.}

\item{species_score_type}{Character string specifying the type of species scores 
to calculate for distance-based ordinations (db-RDA/PCoA/NMDS) when species 
data is supplied via \code{spe}. Must be one of \code{'lc'} (linear combination, default) or 
\code{'wa'} (weighted average). LC scores are calculated via \code{envfit} and 
WA scores via \code{wascores}. Note: WA scores are not supported for PCoA yet.}
}
\value{
A list with elements:
 \describe{
   \item{m}{The original ordination object.}
   \item{type}{Character string with the determined ordination type (e.g., 'RDA', 'db-RDA', 'NMDS').}
   \item{explained_variation}{A numeric vector of eigenvalues divided by total inertia. Returns \code{NA} for DCA and NMDS.}
   \item{choices}{The numeric vector of selected ordination axes (e.g., \code{c(1, 2)}).}
   \item{scaling}{Character string specifying the scaling used for scores (e.g., 'symm').}
   \item{correlation}{Logical; value of the \code{correlation} argument used for scoring.}
   \item{hill}{Logical; value of the \code{hill} argument used for scoring.}
   \item{const}{Numeric vector of scaling constant(s) for scores.}
   \item{axis_names}{Character vector of axis labels (e.g., \code{c('RDA1', 'RDA2')}).}
   \item{site_scores}{Tibble of site (sample) scores (columns: Axis1, Axis2, ...).}
   \item{species_scores}{Tibble of species scores (columns: Axis1, Axis2, ...). Can be \code{NULL} if scores could not be calculated.}
   \item{predictor_scores}{Tibble of biplot/centroid scores for environmental predictors. Can be \code{NULL}.}
   \item{species_names}{Tibble containing a single column, \code{species_names}, with the names of all species, matching the scores.}
   \item{predictor_names}{Tibble containing a single column, \code{predictor_names}, with the names of all predictors/factors. Can be \code{NULL}.}
   \item{env}{The environmental data frame (\code{env}) supplied to the function. Can be \code{NULL}.}
   \item{spe}{The species data frame (\code{spe}) supplied to the function. Can be \code{NULL}.}
   \item{traits}{The trait data frame (\code{traits}) supplied to the function. Can be \code{NULL}.}
 }
}
\description{
\code{gordi_read()} is the first function in the family of \code{gordi_} functions. 
It takes the output of \code{rda}, \code{cca}, \code{capscale}, \code{decorana} and \code{metaMDS} and 
translates in into a format usable by other \code{gordi_} functions. It can also read ordination objects
which were calculated on dissimilarity matrices.
}
\details{
The function uses several arguments passed directly to \code{\link[vegan]{scores}}
to retrieve species, sites and predictors scores. The automatic classification
of the ordination type (`type` element in the returned list) is based on the
class and arguments used in the original \code{vegan} call.

\strong{Handling Distance-Based Ordinations (PCoA, db-RDA, NMDS):}
For ordinations calculated directly on a distance matrix (like PCoA or NMDS), 
species scores cannot be calculated internally by \code{vegan}. But you supply
the \strong{original species data} to the \code{spe} argument, \code{gordi_read}
will calculate species scores using an appropriate method (\code{envfit} for
LC scores, or \code{wascores} for WA scores) based on the \code{species_score_type} argument.

This function was not tested for partial ordination (with \code{Condition()}) yet,
and axis labels are the default ones from \code{vegan}.
}
\examples{
\dontrun{
library(vegan)
library(tidyverse)
data(dune)
data(dune.env)

# Example 1: db-RDA
m_dbRDA <- capscale(dune ~ Management + A1, data = dune.env, distance = "bray")
o_dbRDA <- gordi_read(m_dbRDA, env = dune.env)
print(o_dbRDA)

# Example 2: Simple PCoA (capscale with no predictors)
m_pcoa <- capscale(dune ~ 1, distance = "bray")
o_pcoa <- gordi_read(m_pcoa)
print(o_pcoa$type) # Should be "PCoA"
}
}
\seealso{
\code{\link[gordi]{gordi_sites}}, \code{\link[gordi]{gordi_predict}}, \code{\link[gordi]{gordi_species}}
}
